# 常见问题 (FAQ)

本文档收集了在使用 EVM Scanner 过程中的常见问题及解答。

## 通用问题

### 1. EVM Scanner 支持哪些链？
系统支持所有满足标准以太坊 JSON-RPC 规范的链，包括但不限于：
- Ethereum, BSC (Binance Smart Chain), Polygon (Matic)
- Arbitrum, Optimism, Base
- Avalanche (C-Chain), Fantom
- 各类测试网 (Goerli, Sepolia, Mumbai 等)

### 2. 为什么我配置了过滤器却收不到任何数据？
请按以下顺序检查：
- **合约地址格式**：确保是 `0x` 开头的 40 位 16 进制字符串。
- **Topic0 哈希**：确保使用了事件签名的 Keccak256 哈希。例如 `Transfer(address,address,uint256)` 应为 `0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef`。
- **扫描起始高度**：如果事件发生在 18,000,000 块，但您配置从 18,000,100 开始，则无法收到。
- **RPC 节点同步情况**：检查您的节点是否已同步到最新块。

### 3. 如何处理链重组 (Reorg)？
EVM Scanner 通过 `confirmations` 参数处理重组。建议：
- **以太坊**：设置 12-64 个确认（视对延迟的容忍度而定）。
- **Polygon/BSC**：设置 100-200 个确认（这些链重组较频繁且深度大）。
- 如果发生了超过确认数的重组，扫描器会自动通过 `cursor_rewind` 机制回退并重新扫描。

## 性能与存储

### 4. `batch_size` 应该设置多大？
这取决于您的 RPC 供应商：
- **Alchemy/Infura**：建议 50-100。
- **公共节点**：建议 10-20，否则容易触发限流 (Rate Limit)。
- **私有节点**：可以尝试 500-1000 以获得极速同步。

### 5. 我应该使用 Redis 还是 PostgreSQL 存储进度？
- **Redis**：适合快速实验或极高性能要求的场景，但如果 Redis 未持久化，宕机可能导致扫描进度丢失。
- **Postgres**：推荐生产环境使用，虽然性能略低于 Redis，但数据一致性极高，易于备份。

## 输出 (Sinks)

### 6. Webhook 发送失败会怎样？
如果您启用了 `retry` 配置，系统会按照指数退避算法进行重试。如果重试耗尽依然失败，日志中会记录错误，消息将由于缓冲区溢出而被丢弃（除非下游使用了可靠的消息队列如 Kafka）。

### 7. 能够同时将数据发送到多个地方吗？
可以。只需在 `app.yaml` 中同时启用多个 `outputs` 即可。例如，您可以同时启用 `console` 进行本地观察，启用 `postgres` 进行数据持久化，启用 `webhook` 通知您的 API。

## 开发与扩展

### 8. 我可以在同一个进程里启动多个扫描器吗？
可以。如果您是通过 SDK 引入项目，您可以实例化多个 `scanner.New` 实例，每个实例对应不同的过滤器和 RPC 配置。如果是 CLI 模式，建议启动多个独立进程以便于资源监控。
